.container.show-location.page
  = form_for(location, html: { class: 'form ' + edit_mode_classes }) do |f|
    .row
      .col-md-12
        = render partial: 'breadcrumb', locals: { location: location }
    .row
      .col-md-2
        .display-field
          %img{:src => location.image, :class => 'center-block'}/ 
        .edit-field
          %img{:src => location.image, :class => 'center-block edit-image'}/
      .col-md-4
        %h1.display-field
          = location.title
          %br/
          %small= link_to location.team_name, team_path(location.team)
        .edit-field
          = f.label :title
          = f.text_field :title, class: 'form-control input-lg'
          = f.label :team_id, 'Team'
          = f.select :team_id, options_for_select(all_teams.map { |team| [team.name, team.id, {'data-img-src' => team.image}] }), {}, class: 'form-control  input-md'
          = f.label :description
          = f.text_area :description, placeholder: 'Provide a description of the academy', class: 'form-control', rows: 4
        %p.display-field= location.description
      .col-md-2
        = render partial: 'subnav', :locals => { location: location }
      .col-md-2
        %p 22 Checkins
        %p 7 Reviews
    %hr/
    .row
      .col-md-12
        %h3 Location
        %a{:name => 'location'}
    .row
      .col-md-4
        = f.text_area :directions, placeholder: 'Provide any extra directions to the academy (eg. signage missing; go around the back)', class: 'edit-field form-control', rows: 6 
        %p.display-field= location.directions
      .col-md-3
        %address.display-field
          = location.street
          %br/
          = "#{location.city}, #{location.state}"
          %br/
          = "#{location.postal_code} #{location.country}"
          %br/
          %br/
          %small= location.to_coordinates
        .form-group.edit-field
          = f.label :street
          = f.text_field :street, class: 'form-control'
          = f.label :city
          = f.text_field :city, class: 'form-control'
          = f.label :state
          = f.text_field :state, class: 'form-control'
          = f.label :country
          = f.text_field :country, class: 'form-control'
          = f.label :postal_code
          = f.text_field :postal_code, class: 'form-control'
      .col-md-5.text-center{:style => 'height: 300px'}
        %div.map-canvas
        %big= link_to 'See on larger map', root_path(:center => location.to_coordinates), :data => { :'no-turbolink' => true }
    %hr/
    .row    
      .col-md-12
        = render :partial => 'locations/instructors', :locals => { :location => location }
    .row
      .col-md-12
        %h3 Contact
    .row
      .col-md-6
        .edit-field
          = f.label :phone
          = f.text_field :phone, class: 'form-control'
          = f.label :email
          = f.text_field :email, class: 'form-control'
          = f.label :website
          = f.text_field :website, class: 'form-control'
        %span.display-field
          %b Phone
          = location.phone
        %span.display-field
          %b Email
          = location.email
        %span.display-field
          %b Website
          = location.website
    .row
      .col-md-12
        %h3 Schedule

    .row.edit-field.edit-control
      .col-md-12
        %h3 Edit Controls
      .col-md-12
        %p.small= location.to_json
        %br/
      .col-md-12
        .pull-right
          %button.btn.btn-danger.btn-md{:type => 'button', 
            :data => { :method => :delete,
                       :confirm => true,
                       :url => location_path(location), 
                       :title => 'Are you sure you want to delete this academy?', 
                       :body => "You are performing this action as #{current_user}. Press 'Confirm' to permanently delete this academy. Note that this action cannot be un-done." } } 
            %i.fa.fa-trash
            Delete Academy

          &nbsp;&nbsp;
          %button.btn.btn-default.btn-md{:type => 'button', 'data-cancel-edit' => true} Cancel Editing
          %button.btn.btn-primary.btn-md{:type => 'submit'} Save Changes 

    %br/
  
  = render :partial => 'instructors/add_instructor_dialog'
  = content_for(:scripts) do
    :javascript
      $(document).ready(function() {
        var mapView = new RollFindr.Views.LocationShowView({
          model: #{location.to_json},
          mapModel: #{@map.to_json}, 
          el: $('.show-location')
        });
      });
      
