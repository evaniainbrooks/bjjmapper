= content_for(:title) do
  = location.title
.container.show-location.page
  = form_for(location, html: { class: 'form ' + edit_mode_classes }) do |f|
    .row
      .col-md-12
        = render partial: 'breadcrumb', locals: { location: location }
        = render partial: 'create_message' if created?
    .row
      .col-md-2
        .display-field
          %img{:src => location.image, :class => 'center-block'}/
        .edit-field
          %img{:src => location.image, :class => 'center-block edit-image'}/
      .col-md-5= render partial: 'show_header', :locals => { location: location, f: f }
      .col-md-2= render partial: 'subnav', :locals => { location: location }
      .col-md-3= render partial: 'show_contact', :locals => { location: location, f: f }
    %hr/
    .row
      .col-md-3
        %h3 Location
        %a{:name => 'location'}
        = render partial: 'show_address', locals: { location: location, f: f }
      .col-md-5{:style => 'height: 300px'}
        %div.map-canvas
        -# This is filled in by google maps
      .col-md-4.col-md-offs
        %div.nearby-locations
          -# This is filled in by locations/nearby template
          %h3 Nearby Academies
          %ul.list-unstyled.items
    .row.display-field
      .col-md-5.col-md-offset-3.text-center
        %big= link_to 'See on larger map', root_path(:center => location.to_coordinates), :data => { :'no-turbolink' => true }
    %hr/
    .row
      .col-md-4
        = render :partial => 'locations/instructors', :locals => { :location => location }
      .col-md-8
        %h3 Schedule
        %a{:name => 'schedule'}
        .scheduler
    %hr/
    .row
      .col-md-12
        = render :partial => 'locations/show_reviews', :locals => { :location => location }
    .row.edit-field.edit-control
      .col-md-12
        %h3 Edit Controls
      .col-md-12
        %p.small= location.to_json
        %br/
      .col-md-12
        .pull-right
          %button.delete-field.btn.btn-danger.btn-md{:type => 'button',
            :data => { :method => :delete,
                       :url => location_path(location),
                       :title => 'Are you sure you want to delete this academy?',
                       :body => "You are performing this action as <b>#{current_user.try(:name)}</b>. Press 'Confirm' to permanently delete this academy. Note that this action cannot be un-done." } }
            %i.fa.fa-trash
            Delete Academy

          &nbsp;&nbsp;
          %button.btn.btn-default.btn-md{:type => 'button', 'data-cancel-edit' => true} Cancel Editing
          %button.btn.btn-primary.btn-md{:type => 'submit'} Save Changes

    %br/

  = render :partial => 'instructors/add_instructor_dialog'
  = render :partial => 'events/add_event_modal', locals: { location: location }
= content_for(:scripts) do
  :coffeescript
    $(document).ready ->
      mapView = new RollFindr.Views.LocationShowView({ model: #{location.to_json}, mapModel: #{@map.to_json}, el: $('.show-location')})

= content_for(:head) do
  = render partial: 'opengraph_tags', locals: { location: location }

