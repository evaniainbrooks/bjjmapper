.container.page.show-user
  = form_for(user, html: { class: 'form ' + edit_mode_classes }) do |f|
    .row
      .col-md-10
        = render partial: 'breadcrumb', locals: { user: user }
      .col-md-2.text-right
        %button.pull-right.btn.btn-default.display-field.btn-sm{:style => 'margin-left: 5px', :type => "button", 'data-begin-edit' => true} Edit
        %button.pull-right.btn.btn-default.edit-field.btn-sm{:style => 'margin-left: 5px', :'data-cancel-edit' => true } Cancel
        %button.pull-right.btn.btn-default.btn-sm{'data-report-item' => true}
          %span.report Report
    = render partial: 'welcome_message' if welcome?
    .row
      .col-md-3
        %img.profile.center-block{:alt => "#{user.name} profile image", :src => user.image}
      .col-md-7
        = render partial: 'users/table', locals: { :f => f, :user => user }
        = render partial: 'users/edit_table', locals: { :f => f, :user => user, :show_biography => true }
    %hr.clear/
    .row
      - if user.locations.present?
        .col-md-4
          %h3 Teaching at
          %ul.list-unstyled
            - user.locations.each_with_index do |location, i|
              %li= render partial: 'locations/card', object: location, as: 'location', locals: { location_counter: i }
      .col-md-4.reviews
        %h3 Reviews
        .items.clear
        .empty-message
          %i.text-muted This person has not written any reviews
    %hr/
    .row
      .col-md-12.students
        %h3.pull-left Students
        %button.pull-right.edit-field.btn.btn-small.btn-default.add-student{:style => 'margin-top: -5px', :type => 'button'}
          %i.fa.fa-plus-circle
          Add Student 
        .row.items.clear
        .empty-message
          %i.text-muted No students are listed for this person
    %hr.edit-field/
    .row.edit-field
      .col-md-12
        %h3 Edit Controls
      .col-md-12
        .form-group
          %b Created at 
          = user.created_at
        .form-group
          %b Last updated at 
          = user.updated_at
        .form-group
          %b Last updated by
          = user.modifier
      .col-md-12
        .pull-right
          %button.delete-field.btn.btn-danger.btn-md{:type => 'button',
            :data => { :method => :delete,
                       :url => user_path(user),
                       :title => 'Are you sure you want to delete this user?',
                       :body => "You are performing this action as <b>#{current_user.try(:name)}</b>. Press 'Confirm' to permanently delete this user. Note that this action cannot be un-done." } }
            %i.fa.fa-trash
            Delete User
          %button.btn.btn-default.btn-md{:type => 'button', 'data-cancel-edit' => true} Cancel Editing
          %button.btn.btn-primary.btn-md{:type => 'submit'} Save Changes

  = render :partial => 'users/add_student_dialog', locals: { instructor: user }

= content_for(:scripts) do
  :coffeescript
    $(document).ready ->
      model = new RollFindr.Models.User(#{user.to_json})
      studentsView = new RollFindr.Views.UserStudentsView({ model: model })
      reviewsView = new RollFindr.Views.ReviewsView({ template_name: 'location-review', model: model })
