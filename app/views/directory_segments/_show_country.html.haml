- title = "Brazilian Jiu-Jitsu Academies in #{directory_segment.full_name}"
= content_for :title do
  = title
.container.page.directory
  .row
    .col-md-12
      %h1
        = title
  .row
    .col-md-10
      = render partial: 'breadcrumb'
    .col-md-2.text-right.pull-right
      = render partial: 'create_location_button'
  .row
    .col-md-6.map-view
      .map-canvas{:style => 'height: 400px;'}
    .col-md-6
      - if directory_segment.child_segments.present?
        %h3 Popular cities in #{directory_segment.full_name}
        %ul.list-inline
          - directory_segment.child_segments.sort.each do |city|
            %li= link_to city.name, directory_segment_path(country: directory_segment.name, city: city.name), title: "List of Brazilian Jiu-Jitsu gyms in #{directory_segment.full_name}" 

  - if directory_segment.locations.present?
    %hr/
    .row
      .col-md-12
        %h3
          %span= "Showing #{pluralize(directory_segment.locations.count, 'academy')}"
          %span
            = surround '(', ')' do
              = link_to 'See on map', map_path(zoom: directory_segment.zoom, lat: directory_segment.lat, lng: directory_segment.lng), title: "See map of Brazilian Jiu-Jitsu gyms in #{directory_segment.full_name}"
    .row
      .col-md-12
        = render partial: 'table', locals: { locations: directory_segment.locations, show_legend: directory_segment.child? }

= content_for(:scripts) do
  :coffeescript
    $(document).ready ->
      segmentModel = new RollFindr.Models.DirectorySegment(#{render_json(directory_segment)})
      mapModel = new RollFindr.Models.Map(#{render_json(map)})
      cityView = new RollFindr.Views.DirectorySegmentCountryView({ model: segmentModel, mapModel: mapModel, el: $('.directory') })



